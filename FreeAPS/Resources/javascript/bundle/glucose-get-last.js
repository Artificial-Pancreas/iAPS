var freeaps_glucoseGetLast;(()=>{var e={6237:e=>{function a(e){return e.date||Date.parse(e.display_time)||Date.parse(e.dateString)}function o(e,a){a||(a=0);var o=Math.pow(10,a);return Math.round(e*o)/o}e.exports=function(e){for(var r=(e=e.filter((function(e){return e.glucose||e.sgv})).map((function(e){if(e.glucose=e.glucose||e.sgv,null!==e.glucose)return e})))[0],t=a(r),u=[],n=[],l=[],s=0,c=1;c<e.length;c++){if(void 0!==e[c]&&"cal"===e[c].type){s=c;break}if(void 0!==e[c]&&e[c].glucose>38&&e[c].device===r.device){var g,d=0;void 0!==(E=a(Z=e[c]))&&void 0!==t?(g=Math.round((t-E)/6e4),d=(r.glucose-Z.glucose)/g*5):console.error("Error: date field not found: cannot calculate avgdelta"),-2<g&&g<2.5?(r.glucose=(r.glucose+Z.glucose)/2,t=(t+E)/2):2.5<g&&g<17.5?(n.push(d),2.5<g&&g<7.5&&u.push(d)):17.5<g&&g<42.5&&l.push(d)}}var h,i,v=0,f=0,p=0,M=0,_=0,b=0,w=0,k=0,x=0,S=0,F=0,D=0,I=0,m=0,y="autoISF Mod14-Debug: ";u.length>0&&(v=u.reduce((function(e,a){return e+a}))/u.length),n.length>0&&(f=n.reduce((function(e,a){return e+a}))/n.length),l.length>0&&(p=l.reduce((function(e,a){return e+a}))/l.length);var G=r.glucose,L=r.glucose,q=0;for(c=1;c<e.length;c++){var E=a(Z=e[c]);if(Math.round((t-E)/6e4)-q>13)break;if(!(Z.glucose>.95*L&&Z.glucose<1.05*L))break;L=(G+=Z.glucose)/(c+1),q=Math.round((t-E)/6e4)}i=L,h=q;M=1.05,_=1.15,b=1.4,G=0;var P,j,z=0,A=0,B=0,C=7.5;for(c=0;c<e.length;c++){if((j=(t-(E=a(Z=e[c])))/6e4)>C&&7.5==C&&(M=5*-(P=(c*B-z*G)/(c*A-z*z)),C=17.5),j>C&&17.5==C&&(_=5*-(P=(c*B-z*G)/(c*A-z*z)),C=42.5),j>C&&42.5==C){b=5*-(P=(c*B-z*G)/(c*A-z*z));break}z+=j,A+=j*j,G+=Z.glucose,Z.glucose*Z.glucose,B+=Z.glucose*j}w=0,k=0,x=0,F=0,S=0;var H=0,J=0,K=0;D=0,I=0,m=0;if(e.length<=3)w=0,k=0,x=0,F=0,S=0,D=0,I=0,m=0;else{var N=0,O=0,Q=0,R=0,T=0,U=0,V=0,W=0,X=a(e[0]),Y=0;for(c=0;c<e.length;c++){var Z,$=((E=a(Z=e[c]))-X)/1e3;if(-$>2820)break;if($<Y-450){c<3&&(w=-Y/60,k=0,x=0,F=0,S=0,D=0,I=0,m=0);break}Y=$;var ee=Z.glucose;O+=$,Q+=Math.pow($,2),R+=Math.pow($,3),T+=Math.pow($,4),N+=ee,U+=$*ee,V+=Math.pow($,2)*ee;var ae=c+1,oe=0,re=0,te=0,ue=0;if(ae>3&&(oe=T*(Q*ae-O*O)-R*(R*ae-O*Q)+Q*(R*O-Q*Q),re=V*(Q*ae-O*O)-U*(R*ae-O*Q)+N*(R*O-Q*Q),te=T*(U*ae-N*O)-R*(V*ae-N*Q)+Q*(V*O-U*Q),ue=T*(Q*N-O*U)-R*(R*N-O*V)+Q*(R*U-Q*V)),0!=oe){var ne=re/oe;P=te/oe;for(var le=ue/oe,se=N/ae,ce=0,ge=0,de=0;de<=c;de++){var he=e[de],ie=a(he);ce+=Math.pow(he.glucose-se,2);var ve=(ie-X)/1e3;ge+=Math.pow(he.glucose-ne*Math.pow(ve,2)-P*ve-le,2)}S=.64;0!=ce&&(S=1-ge/ce),ae>3&&S>W&&(W=S,w=-$/60,k=-(ne*Math.pow(-300,2)-5*P*60),x=ne*Math.pow(300,2)+5*P*60,F=2*ne*300*300,D=le,I=300*P,m=300*ne*300,H=ne,J=P,K=le)}}y+="coeffs a/b/c=("+o(H,2)+" / "+o(J,2)+" / "+o(K,2)+"); bg date="+X+"; ",y+="Parabola Fits a0/a1/a2=("+o(D,2)+" / "+o(I,2)+" / "+o(m,2)+"); "}return y+="Slopes 05/15/40=("+o(M,2)+" / "+o(_,2)+" / "+o(b,2)+"); ",{delta:Math.round(100*v)/100,glucose:Math.round(100*r.glucose)/100,noise:Math.round(r.noise),short_avgdelta:Math.round(100*f)/100,long_avgdelta:Math.round(100*p)/100,autoISF_average:Math.round(100*i)/100,autoISF_duration:Math.round(100*h)/100,dura_p:Math.round(100*w)/100,delta_pl:Math.round(100*k)/100,delta_pn:Math.round(100*x)/100,bg_acceleration:F,r_squ:Math.round(100*S)/100,parabola_fit_a0:Math.round(100*D)/100,parabola_fit_a1:Math.round(100*I)/100,parabola_fit_a2:Math.round(100*m)/100,pp_debug:y,date:t,last_cal:s,device:r.device}}}},a={};var o=function o(r){var t=a[r];if(void 0!==t)return t.exports;var u=a[r]={exports:{}};return e[r](u,u.exports,o),u.exports}(6237);freeaps_glucoseGetLast=o})();